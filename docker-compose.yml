services:
  db:
#    build:
#      context: pg_uuidv7
#      args:
#        PG_MAJOR_VERSION: 16
    image: ghcr.io/mawoka-myblock/pg_uuidv7:main
    environment:
      POSTGRES_PASSWORD: postgres
      POSTGRES_DB: fedi_print
    volumes:
      - db:/var/lib/postgresql/data
    ports:
      - 5432:5432
  meilisearch:
    image: getmeili/meilisearch:v1.7
    volumes:
      - search:/meili_data
    ports:
      - 7700:7700
    environment:
      MEILI_NO_ANALYTICS: "true"
      MEILI_MASTER_KEY: MASTER_KEY
  caddy:
    image: caddy:alpine
    volumes:
      - ./Caddyfile:/etc/caddy/Caddyfile
    network_mode: "host"
    privileged: true
  minio:
    image: bitnami/minio
    environment:
      MINIO_ROOT_USER: fediprint
      MINIO_ROOT_PASSWORD: fediprint
    volumes:
      - minio:/bitnami/minio/data
    ports:
      - 9000:9000
      - 9001:9001
volumes:
  db:
  search:
  minio: