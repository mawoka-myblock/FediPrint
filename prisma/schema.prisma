// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider        = "cargo prisma"
  output          = "../src/prisma.rs"
  previewFeatures = ["postgresqlExtensions"]
}

datasource db {
  provider   = "postgresql"
  url        = env("DATABASE_URL")
  extensions = [pgcrypto]
}

model Account {
  id           String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  registeredAt DateTime @default(now())
  password     String
  email        String   @unique
  verified     String?  @default(dbgenerated("gen_random_uuid()"))
  profileId    String   @unique @db.Uuid
  privateKey   String
  profile      Profile  @relation(fields: [profileId], references: [id])
}

model Profile {
  id           String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  username     String
  server       String
  serverId     String    @unique
  displayName  String
  summary      String    @default("")
  inbox        String
  outbox       String
  publicKey    String
  registeredAt DateTime  @default(now()) @db.Date
  followers    Profile[] @relation("Followers")
  following    Profile[] @relation("Followers")
  // activities Activity[] @relation("Actor")
  account      Account?
}

model Note {
  id        BigInt    @id @default(autoincrement())
  createdAt DateTime  @default(now())
  content   String
  hashtags  String[]
  mentions  Profile[]
  inReplyTo Note?
  replies   Note[]
}

// Define the Activity table to store information about activities
// model Activity {
//   id        String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
//   type      String
//   actor     Profile  @relation("Actor", references: [id], fields: [actorId])
//   object    Object   @relation(fields: [objectId], references: [id])
//   objectId  String
//   published DateTime
//   actorId   String   @db.Uuid
// }

// // Define the Object table to store information about objects
// model Object {
//   id       String     @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
//   type     String
//   // Add more fields as needed for your specific use case
//   Activity Activity[]
// }
